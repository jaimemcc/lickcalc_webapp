<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LickCalc GUI - Help Documentation</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS to match your app -->
    <style>
        body {
            background-color: #f8f9fa;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        .help-header {
            background: linear-gradient(135deg, #007bff, #17a2b8);
            color: white;
            padding: 30px 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .help-header h1 {
            margin: 0 0 10px 0;
            font-size: 2rem;
        }
        .help-header p {
            margin: 0;
            font-size: 1rem;
        }
        .help-layout {
            display: flex;
            min-height: calc(100vh - 120px);
        }
        .sidebar {
            position: sticky;
            top: 120px;
            width: 280px;
            height: calc(100vh - 140px);
            background-color: white;
            border-right: 1px solid #dee2e6;
            overflow-y: auto;
            flex-shrink: 0;
            box-shadow: 2px 0 5px rgba(0,0,0,0.05);
        }
        .sidebar-content {
            padding: 20px;
        }
        .sidebar h3 {
            font-size: 1.1rem;
            margin: 0 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #007bff;
            color: #343a40;
        }
        .sidebar ul {
            list-style-type: none;
            padding-left: 0;
            margin: 0;
        }
        .sidebar li {
            margin: 0;
        }
        .sidebar a {
            display: block;
            text-decoration: none;
            color: #495057;
            padding: 8px 12px;
            border-radius: 5px;
            transition: all 0.2s;
            font-size: 0.9rem;
        }
        .sidebar a:hover {
            background-color: #e3f2fd;
            color: #007bff;
            padding-left: 16px;
        }
        .sidebar a.active {
            background-color: #007bff;
            color: white;
        }
        .main-content {
            flex: 1;
            padding: 30px 40px;
            max-width: 900px;
            overflow-y: auto;
        }
        .section-header {
            color: #007bff;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            margin-top: 0;
            margin-bottom: 20px;
            scroll-margin-top: 140px;
        }
        .card {
            margin-bottom: 20px;
            border: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        .card-header {
            background-color: #007bff;
            color: white;
            font-weight: bold;
            border-radius: 8px 8px 0 0 !important;
        }
        .parameter-box {
            background-color: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .parameter-box h6 {
            margin-top: 0;
            color: #1565c0;
        }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        .warning-box {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .tip-box {
            background-color: #d1edff;
            border-left: 4px solid #0dcaf0;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .footer {
            background-color: #343a40;
            color: white;
            padding: 30px 40px;
            text-align: center;
        }
        .footer p {
            margin: 5px 0;
        }
        
        /* Scrollbar styling for sidebar */
        .sidebar::-webkit-scrollbar {
            width: 6px;
        }
        .sidebar::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .sidebar::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 3px;
        }
        .sidebar::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Responsive design for smaller screens */
        @media (max-width: 768px) {
            .help-layout {
                flex-direction: column;
            }
            .sidebar {
                position: relative;
                top: 0;
                width: 100%;
                height: auto;
                border-right: none;
                border-bottom: 1px solid #dee2e6;
            }
            .main-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="help-header">
        <div style="max-width: 1200px; margin: 0 auto;">
            <h1>üìñ LickCalc GUI Help</h1>
            <p>Comprehensive guide for analyzing licking microstructure in rodent behavior experiments</p>
        </div>
    </div>

    <!-- Main Layout with Sidebar and Content -->
    <div class="help-layout">
        <!-- Sticky Sidebar with Table of Contents -->
        <aside class="sidebar">
            <div class="sidebar-content">
                <h3>Table of Contents</h3>
                <ul>
                    <li><a href="#overview">üìñ Overview</a></li>
                    <li><a href="#getting-started">üöÄ Getting Started</a></li>
                    <li><a href="#file-formats">üìÅ File Formats</a></li>
                    <li><a href="#session-analysis">üìä Session Analysis</a></li>
                    <li><a href="#time-window">‚è±Ô∏è Time Window</a></li>
                    <li><a href="#microstructural">üî¨ Microstructure</a></li>
                    <li><a href="#parameters">‚öôÔ∏è Parameters</a></li>
                    <li><a href="#data-export">üíæ Data Export</a></li>
                    <li><a href="#results-table">üìã Results Table</a></li>
                    <li><a href="#troubleshooting">üîß Troubleshooting</a></li>
                    <li><a href="#glossary">üìö Glossary</a></li>
                </ul>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">

            <!-- Overview Section -->
            <section id="overview">
            <h2 class="section-header">üìñ Overview</h2>
            <div class="card">
                <div class="card-body">
                    <p>LickCalc GUI is a web-based application for analyzing licking microstructure in rodent behavioral experiments. It processes timestamp data from licking events and provides detailed statistical analysis including:</p>
                    <ul>
                        <li><strong>Session-level analysis:</strong> Overall licking patterns over time</li>
                        <li><strong>Microstructural analysis:</strong> Burst patterns, intraburst frequency, and lick durations</li>
                        <li><strong>Statistical modeling:</strong> Weibull distribution fitting for burst probability</li>
                        <li><strong>Data export:</strong> Excel exports with customizable data selection</li>
                    </ul>
                </div>
            </div>
        </section>

            <!-- Getting Started Section -->
            <section id="getting-started">
            <h2 class="section-header">üöÄ Getting Started</h2>
            <div class="accordion" id="gettingStartedAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#step1">
                            Step 1: Select File Type
                        </button>
                    </h2>
                    <div id="step1" class="accordion-collapse collapse show" data-bs-parent="#gettingStartedAccordion">
                        <div class="accordion-body">
                            <p>Choose your data file format from the dropdown:</p>
                            <ul>
                                <li><strong>Med Associates:</strong> For .txt files from Med-PC systems</li>
                                <li><strong>CSV/TXT:</strong> For comma-separated or tab-separated files</li>
                                <li><strong>DD Lab:</strong> For DD Lab specific format files</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#step2">
                            Step 2: Upload Your Data
                        </button>
                    </h2>
                    <div id="step2" class="accordion-collapse collapse" data-bs-parent="#gettingStartedAccordion">
                        <div class="accordion-body">
                            <p>Upload your data file by either:</p>
                            <ul>
                                <li>Dragging and dropping the file onto the upload area</li>
                                <li>Clicking "Select Files" to browse for your file</li>
                            </ul>
                            <div class="tip-box">
                                <strong>üí° Tip:</strong> The app will automatically detect columns in your file and populate the onset/offset dropdowns.
                            </div>
                            <div class="warning-box">
                                <strong>‚ö†Ô∏è File Validation:</strong> After upload, watch for validation messages. Green indicates successful parsing, red indicates errors with specific details about what went wrong. If you change the file type dropdown, the file will be re-parsed automatically.
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#step3">
                            Step 3: Configure Data Columns
                        </button>
                    </h2>
                    <div id="step3" class="accordion-collapse collapse" data-bs-parent="#gettingStartedAccordion">
                        <div class="accordion-body">
                            <p>Select which columns contain your data:</p>
                            <ul>
                                <li><strong>Onset Array:</strong> Column containing lick onset timestamps (required)</li>
                                <li><strong>Offset Array:</strong> Column containing lick offset timestamps (optional, for lick duration analysis)</li>
                            </ul>
                            <div class="warning-box">
                                <strong>‚ö†Ô∏è Note:</strong> If you only have onset data, select "None" for the offset array. This will disable lick duration analysis but all other features will work normally.
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#step4">
                            Step 4: Analyze and Export
                        </button>
                    </h2>
                    <div id="step4" class="accordion-collapse collapse" data-bs-parent="#gettingStartedAccordion">
                        <div class="accordion-body">
                            <p>Once your data is loaded:</p>
                            <ul>
                                <li>Adjust analysis parameters using the sliders</li>
                                <li>View real-time updates in the graphs and statistics</li>
                                <li>Export data to Excel for further analysis</li>
                                <li>Add results to the comparison table</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#step5">
                            Optional: Upload Custom Config
                        </button>
                    </h2>
                    <div id="step5" class="accordion-collapse collapse" data-bs-parent="#gettingStartedAccordion">
                        <div class="accordion-body">
                            <p>Customize default analysis parameters by uploading a configuration file:</p>
                            <ul>
                                <li>Create a YAML file with your preferred default values</li>
                                <li>Use <code>custom_config_example.yaml</code> from the repository as a template</li>
                                <li>Upload via the configuration section (if available in your interface)</li>
                                <li>Settings will apply immediately and persist for the session</li>
                            </ul>
                            <div class="tip-box">
                                <strong>üí° Pro Tip:</strong> Create different config files for different experiment types or labs to ensure consistent analysis parameters across your team.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

            <!-- File Formats Section -->
            <section id="file-formats">
            <h2 class="section-header">üìÅ Supported File Formats</h2>
            <div class="row">
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">Med Associates</div>
                        <div class="card-body">
                            <p>Text files from Med-PC systems with array format:</p>
                            <div class="code-block">
A: 0.123 1.456 2.789<br>
B: 0.145 1.478 2.801<br>
...
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">CSV/TXT</div>
                        <div class="card-body">
                            <p>Comma or tab-separated files with columns:</p>
                            <div class="code-block">
time,licks,other<br>
0.123,1,data<br>
1.456,1,data<br>
...
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">DD Lab</div>
                        <div class="card-body">
                            <p>Custom DD Lab format with specific parsing rules for behavioral data.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

            <!-- Session Analysis Section -->
            <section id="session-analysis">
            <h2 class="section-header">üìä Session Analysis</h2>
            <div class="card">
                <div class="card-body">
                    <h5>Session Overview Graph</h5>
                    <p>The session graph shows the overall pattern of licking throughout your experimental session. You can choose between two visualization modes:</p>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="parameter-box">
                                <strong>Standard Histogram</strong><br>
                                Shows licks per time bin, allowing you to see periods of high and low licking activity.
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="parameter-box">
                                <strong>Cumulative Plot</strong><br>
                                Shows the cumulative number of licks over time, useful for seeing overall session progress.
                            </div>
                        </div>
                    </div>
                    
                    <h6 class="mt-3">Bin Size Control</h6>
                    <p>Adjust the time bin size to change the temporal resolution of your analysis. Smaller bins show more detail but may be noisier.</p>
                </div>
            </div>
        </section>

            <!-- Time Window Selection Section -->
            <section id="time-window">
            <h2 class="section-header">‚è±Ô∏è Time Window Selection</h2>
            <div class="card">
                <div class="card-body">
                    <h5>Analyze Specific Time Periods</h5>
                    <p>Use the time window controls to analyze only specific portions of your session:</p>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Manual Input</h6>
                            <ul>
                                <li><strong>Start Time:</strong> Enter the beginning of your analysis window (in minutes)</li>
                                <li><strong>End Time:</strong> Enter the end of your analysis window (in minutes)</li>
                                <li><strong>Apply Button:</strong> Click to update the analysis with your specified times</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6>Interactive Slider</h6>
                            <ul>
                                <li><strong>Drag Range:</strong> Use the range slider to visually select your time window</li>
                                <li><strong>Real-time Update:</strong> Analysis updates automatically as you drag</li>
                                <li><strong>Tooltips:</strong> Hover to see exact time values</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="tip-box">
                        <strong>üí° Use Cases:</strong>
                        <ul>
                            <li>Analyze only the first hour of a long session</li>
                            <li>Focus on periods of high activity</li>
                            <li>Compare early vs. late session behavior</li>
                            <li>Exclude warm-up or cool-down periods</li>
                        </ul>
                    </div>
                    
                    <div class="warning-box">
                        <strong>‚ö†Ô∏è Important:</strong> All downstream analyses (microstructure, bursts, statistics) will use only the data within your selected time window. Results table entries will include the time window information for easy comparison.
                    </div>
                </div>
            </div>
        </section>

            <!-- Microstructural Analysis Section -->
            <section id="microstructural">
            <h2 class="section-header">üî¨ Microstructural Analysis</h2>
            <div class="row">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">Burst Analysis</div>
                        <div class="card-body">
                            <p><strong>Burst Definition:</strong> A sequence of licks separated by intervals shorter than the interburst interval threshold.</p>
                            
                            <h6>Key Metrics:</h6>
                            <ul>
                                <li><strong>Number of Bursts:</strong> Total burst count in session</li>
                                <li><strong>Mean Licks per Burst:</strong> Average burst size</li>
                                <li><strong>Weibull Parameters:</strong> Œ± and Œ≤ parameters from probability distribution fitting</li>
                            </ul>
                            
                            <div class="warning-box" style="margin-top: 15px;">
                                <strong>‚ö†Ô∏è Weibull Analysis Requirements:</strong> Weibull distribution fitting requires a minimum number of bursts (default: 10, configurable in config file). If fewer bursts are detected, Weibull statistics will show "N/A" and the burst probability plot title will indicate insufficient data.
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">Intraburst Frequency</div>
                        <div class="card-body">
                            <p><strong>Definition:</strong> The frequency of licking within bursts, calculated from interlick intervals (ILIs) within bursts.</p>
                            
                            <h6>Typical Values:</h6>
                            <ul>
                                <li>Normal range: 6-8 Hz</li>
                                <li>Higher frequency may indicate more efficient licking</li>
                                <li>Displayed as histogram of ILIs</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card mt-3">
                <div class="card-header">Lick Duration Analysis</div>
                <div class="card-body">
                    <p><strong>Requirements:</strong> Both onset and offset data must be available.</p>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Lick Lengths</h6>
                            <ul>
                                <li>Histogram of individual lick durations</li>
                                <li>Typically range from 50-200ms</li>
                                <li>Longer licks may indicate different tongue contact patterns</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6>Long Licks</h6>
                            <ul>
                                <li>Licks exceeding the long lick threshold</li>
                                <li>May represent inefficient contact or spillage</li>
                                <li>Count and maximum duration reported</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

            <!-- Parameters Section -->
            <section id="parameters">
            <h2 class="section-header">‚öôÔ∏è Parameters Explained</h2>
            <div class="row">
                <div class="col-md-6">
                    <div class="parameter-box">
                        <h6>üïê Interburst Interval (IBI)</h6>
                        <p><strong>Range:</strong> 0.25 - 2.0 seconds</p>
                        <p><strong>Default:</strong> 0.5 seconds</p>
                        <p>The minimum gap between licks that defines the end of one burst and the beginning of another. Shorter intervals = more bursts with fewer licks each.</p>
                    </div>
                    
                    <div class="parameter-box">
                        <h6>üìä Minimum Licks per Burst</h6>
                        <p><strong>Range:</strong> 1 - 10 licks</p>
                        <p><strong>Default:</strong> 3 licks</p>
                        <p>The minimum number of licks required to classify a sequence as a burst. Sequences with fewer licks are excluded from burst analysis.</p>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="parameter-box">
                        <h6>‚è±Ô∏è Long Lick Threshold</h6>
                        <p><strong>Range:</strong> 0.1 - 1.0 seconds</p>
                        <p><strong>Default:</strong> 0.3 seconds</p>
                        <p>Licks longer than this duration are classified as "long licks" and may indicate inefficient contact or spillage events.</p>
                        <p><strong>Remove Long Licks:</strong> Optional checkbox to exclude long licks from all analyses. When enabled, licks exceeding the threshold are filtered out. Requires offset data.</p>
                    </div>
                    
                    <div class="parameter-box">
                        <h6>üìà Bin Size (Dynamic)</h6>
                        <p><strong>Adapts to Session Length:</strong></p>
                        <ul style="margin-bottom: 0;">
                            <li>‚â§1 hour: 1-600 seconds</li>
                            <li>1-4 hours: 1-600 minutes</li>
                            <li>>4 hours: 1-24 hours</li>
                        </ul>
                        <p style="margin-top: 10px;"><strong>Default:</strong> 60 seconds (or equivalent in minutes/hours)</p>
                        <p>The slider automatically adjusts range and units based on your session length for optimal analysis granularity.</p>
                    </div>
                    
                    <div class="parameter-box">
                        <h6>üìè Session Length</h6>
                        <p><strong>Units:</strong> seconds (s), minutes (min), or hours (hr)</p>
                        <p><strong>Default:</strong> 3600 seconds (1 hour)</p>
                        <p>Define the total duration of your experimental session. The unit dropdown allows you to work in your preferred time scale. All internal calculations use seconds.</p>
                    </div>
                </div>
            </div>
            
            <div class="card mt-3">
                <div class="card-header">üîß Configuration Files</div>
                <div class="card-body">
                    <h5>Customizing Default Settings</h5>
                    <p>You can customize default analysis parameters by uploading a custom configuration file:</p>
                    
                    <h6>Available Settings:</h6>
                    <ul>
                        <li><strong>Microstructure parameters:</strong> IBI, min licks per burst, long lick threshold, min bursts for Weibull analysis</li>
                        <li><strong>Session settings:</strong> Default length, length unit, figure type, bin size</li>
                        <li><strong>Output settings:</strong> Default animal ID</li>
                    </ul>
                    
                    <div class="tip-box">
                        <strong>üí° Creating a Config File:</strong>
                        <ol style="margin-bottom: 0;">
                            <li>Use YAML format (key: value pairs)</li>
                            <li>See <code>custom_config_example.yaml</code> in the repository</li>
                            <li>Upload via the config upload section in the app</li>
                        </ol>
                    </div>
                    
                    <div class="warning-box">
                        <strong>‚ö†Ô∏è Note:</strong> Configuration changes apply immediately after upload and persist for the session. Invalid config files will be rejected with an error message.
                    </div>
                </div>
            </div>
        </section>

            <!-- Data Export Section -->
            <section id="data-export">
            <h2 class="section-header">üíæ Data Export</h2>
            <div class="card">
                <div class="card-body">
                    <h5>Excel Export Options</h5>
                    <p>Export your analysis results to Excel format with customizable data selection:</p>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Available Data Types:</h6>
                            <ul>
                                <li><strong>Session Histogram Data:</strong> Time bins and lick counts</li>
                                <li><strong>Intraburst Frequency Data:</strong> ILI distributions</li>
                                <li><strong>Lick Lengths Data:</strong> Duration histograms (requires offset data)</li>
                                <li><strong>Burst Histogram Data:</strong> Burst size distributions</li>
                                <li><strong>Burst Probability Data:</strong> Weibull fitting data</li>
                                <li><strong>Burst Details Data:</strong> Individual burst information (start/end times, lick counts, etc.)</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6>Export Features:</h6>
                            <ul>
                                <li>Multiple Excel sheets per export</li>
                                <li>Summary sheet with all key statistics</li>
                                <li>Animal ID and timestamp tracking</li>
                                <li>Source filename preservation</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="tip-box">
                        <strong>üí° Pro Tip:</strong> Use the Animal ID field to organize your data exports. This makes it easier to track multiple subjects in your analysis pipeline.
                    </div>
                </div>
            </div>
        </section>

            <!-- Results Table Section -->
            <section id="results-table">
            <h2 class="section-header">üìã Results Management</h2>
            
            <div class="card">
                <div class="card-header">üîç Epoch/Division Analysis</div>
                <div class="card-body">
                    <h5>Analyzing Session Subdivisions</h5>
                    <p>The app supports dividing your session into temporal or burst-based epochs for detailed analysis:</p>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Analysis Epoch Options:</h6>
                            <ul>
                                <li><strong>Whole Session:</strong> Analyze entire session (default)</li>
                                <li><strong>Divide by 2/3/4:</strong> Split session into equal parts</li>
                                <li><strong>First n Bursts:</strong> Analyze only the first N bursts</li>
                            </ul>
                            
                            <h6 class="mt-3">Division Methods:</h6>
                            <ul>
                                <li><strong>By Time:</strong> Split session into equal time intervals</li>
                                <li><strong>By Burst Number:</strong> Split based on burst count (e.g., first vs. last half of bursts)</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6>Use Cases:</h6>
                            <ul>
                                <li>Compare early vs. late session behavior</li>
                                <li>Track learning or satiation effects over time</li>
                                <li>Analyze acquisition phase (first N bursts only)</li>
                                <li>Assess stability of licking patterns</li>
                            </ul>
                            
                            <div class="tip-box" style="margin-top: 10px;">
                                <strong>üí° Example:</strong> Select "Divide by 2" and "By Time" to compare the first and second halves of your session. Each division will be added as a separate row in the results table.
                            </div>
                        </div>
                    </div>
                    
                    <div class="warning-box">
                        <strong>‚ö†Ô∏è Important:</strong> When using divisions, each segment is analyzed independently. Statistics like Weibull parameters require a minimum number of bursts (default: 10) and will show "N/A" if insufficient data exists in a segment.
                    </div>
                </div>
            </div>
            
            <div class="card mt-3">
                <div class="card-body">
                    <h5>Results Summary Table</h5>
                    <p>Collect and compare results from multiple analyses in an interactive table:</p>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Table Features:</h6>
                            <ul>
                                <li><strong>Add Results:</strong> Add current analysis to comparison table</li>
                                <li><strong>Edit Cells:</strong> Modify Animal IDs and other editable fields</li>
                                <li><strong>Delete Rows:</strong> Remove unwanted entries</li>
                                <li><strong>Export Options:</strong> Export individual rows or full table</li>
                                <li><strong>Clear All:</strong> Remove all entries at once</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6>Automatic Statistics:</h6>
                            <p>When you have multiple entries, the table automatically calculates:</p>
                            <ul>
                                <li><strong>Mean:</strong> Average values across subjects</li>
                                <li><strong>SD:</strong> Standard deviation</li>
                                <li><strong>N:</strong> Sample size for each measure</li>
                                <li><strong>SE:</strong> Standard error of the mean</li>
                            </ul>
                            
                            <div class="tip-box" style="margin-top: 10px;">
                                <strong>üí° Workflow:</strong> Load each subject's data file, adjust parameters as needed, select your analysis epoch, then click "Add Current Results to Table". Repeat for all subjects, then export the full table for statistical analysis.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

            <!-- Troubleshooting Section -->
            <section id="troubleshooting">
            <h2 class="section-header">üîß Troubleshooting</h2>
            <div class="accordion" id="troubleshootingAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#issue1">
                            File Upload Issues
                        </button>
                    </h2>
                    <div id="issue1" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                        <div class="accordion-body">
                            <strong>Problem:</strong> File won't upload or process<br>
                            <strong>Solutions:</strong>
                            <ul>
                                <li>Check file format matches selected type</li>
                                <li>Ensure file is not corrupted</li>
                                <li>Verify file contains numeric timestamp data</li>
                                <li>Try a smaller test file first</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#issue2">
                            No Graphs Showing
                        </button>
                    </h2>
                    <div id="issue2" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                        <div class="accordion-body">
                            <strong>Problem:</strong> Graphs are empty or not updating<br>
                            <strong>Solutions:</strong>
                            <ul>
                                <li>Ensure onset array is selected correctly</li>
                                <li>Check that your data contains valid timestamps</li>
                                <li>Try adjusting parameter sliders</li>
                                <li>Refresh the browser page</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#issue3">
                            Lick Duration Analysis Not Working
                        </button>
                    </h2>
                    <div id="issue3" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                        <div class="accordion-body">
                            <strong>Problem:</strong> Long licks showing "N/A" or not calculated<br>
                            <strong>Solutions:</strong>
                            <ul>
                                <li>Ensure you have both onset and offset data</li>
                                <li>Select proper offset array (not "None")</li>
                                <li>Check that onset and offset arrays have matching lengths</li>
                                <li>Verify offset timestamps are after onset timestamps</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#issue4">
                            Export Problems
                        </button>
                    </h2>
                    <div id="issue4" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                        <div class="accordion-body">
                            <strong>Problem:</strong> Excel export fails or empty<br>
                            <strong>Solutions:</strong>
                            <ul>
                                <li>Ensure data is loaded and analyzed first</li>
                                <li>Select at least one data type for export</li>
                                <li>Enter a valid Animal ID</li>
                                <li>Check browser download settings</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#issue5">
                            Weibull Statistics Showing "N/A"
                        </button>
                    </h2>
                    <div id="issue5" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                        <div class="accordion-body">
                            <strong>Problem:</strong> Weibull parameters (Œ±, Œ≤, r¬≤) display "N/A"<br>
                            <strong>Cause:</strong> Insufficient number of bursts for statistical fitting<br>
                            <strong>Solutions:</strong>
                            <ul>
                                <li>Check if you have at least 10 bursts (default minimum threshold)</li>
                                <li>Decrease the interburst interval to identify more bursts</li>
                                <li>Decrease minimum licks per burst threshold</li>
                                <li>Ensure your time window captures enough bursting behavior</li>
                                <li>Adjust the minimum burst threshold in your config file if appropriate for your experiment</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#issue6">
                            File Re-upload Not Working
                        </button>
                    </h2>
                    <div id="issue6" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                        <div class="accordion-body">
                            <strong>Problem:</strong> Re-uploading the same file doesn't update the analysis<br>
                            <strong>Cause:</strong> Browser caching of file uploads<br>
                            <strong>Solutions:</strong>
                            <ul>
                                <li>Change the file type dropdown before re-uploading (this triggers re-parsing)</li>
                                <li>Upload a different file, then upload the original file again</li>
                                <li>Refresh the browser page and upload again</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#issue7">
                            Config File Upload Errors
                        </button>
                    </h2>
                    <div id="issue7" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                        <div class="accordion-body">
                            <strong>Problem:</strong> Custom configuration file rejected<br>
                            <strong>Solutions:</strong>
                            <ul>
                                <li>Ensure file is valid YAML format (check indentation with spaces, not tabs)</li>
                                <li>Use the provided <code>custom_config_example.yaml</code> as a template</li>
                                <li>Verify all parameter values are within valid ranges</li>
                                <li>Check for typos in parameter names</li>
                                <li>Ensure numeric values don't have quotes around them</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

            <!-- Glossary Section -->
            <section id="glossary">
            <h2 class="section-header">üìö Glossary</h2>
            <div class="card">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <dl>
                                <dt>Burst</dt>
                                <dd>A sequence of licks separated by intervals shorter than the interburst interval threshold</dd>
                                
                                <dt>Interlick Interval (ILI)</dt>
                                <dd>Time between consecutive lick onsets within a burst</dd>
                                
                                <dt>Intraburst Frequency</dt>
                                <dd>Rate of licking within bursts, typically 6-8 Hz in rodents</dd>
                                
                                <dt>Interburst Interval (IBI)</dt>
                                <dd>Minimum gap between licks that defines burst boundaries</dd>
                                
                                <dt>Long Lick</dt>
                                <dd>Lick duration exceeding the long lick threshold, may indicate inefficient contact</dd>
                            </dl>
                        </div>
                        <div class="col-md-6">
                            <dl>
                                <dt>Onset</dt>
                                <dd>Timestamp when tongue contact begins (required data)</dd>
                                
                                <dt>Offset</dt>
                                <dd>Timestamp when tongue contact ends (optional, enables duration analysis)</dd>
                                
                                <dt>Weibull Distribution</dt>
                                <dd>Statistical model used to fit burst size probability distributions</dd>
                                
                                <dt>Microstructure</dt>
                                <dd>Fine-grained temporal patterns of licking behavior within bursts</dd>
                                
                                <dt>Session</dt>
                                <dd>Complete behavioral recording period, analyzed for overall licking patterns</dd>
                            </dl>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        </main>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2025 LickCalc GUI - Behavioral Microstructure Analysis Tool</p>
        <p>For technical support or questions about the analysis methods, consult your research supervisor or the documentation.</p>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Smooth scrolling and active link highlighting -->
    <script>
        // Smooth scrolling for internal links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Highlight active section in sidebar based on scroll position
        const sections = document.querySelectorAll('section[id]');
        const sidebarLinks = document.querySelectorAll('.sidebar a[href^="#"]');
        
        function highlightActiveSection() {
            let current = '';
            const scrollPosition = window.pageYOffset + 200; // Offset for header
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (scrollPosition >= sectionTop - 50) {
                    current = section.getAttribute('id');
                }
            });
            
            sidebarLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        }
        
        // Update on scroll and load
        window.addEventListener('scroll', highlightActiveSection);
        window.addEventListener('load', highlightActiveSection);
    </script>
</body>
</html>
